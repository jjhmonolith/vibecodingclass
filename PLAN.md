# 바이브코딩 교육 플랫폼 - MVP 기획 문서

## 1. 프로젝트 개요

**목표**: 바이브코딩을 처음 하는 학생이 AI와 대화하며 단일 HTML 프로젝트를 완성하는 교육용 웹 환경

**핵심 컨셉**:
- 코드를 직접 보거나 작성하지 않음
- 자연어 대화만으로 웹 페이지를 만듦
- AI가 단계별로 안내하며 학생의 아이디어를 구체화

---

## 2. 기술 스택

| 레이어 | 기술 | 선택 이유 |
|--------|------|-----------|
| 프레임워크 | Next.js 14 (App Router) | 프론트+백엔드 통합, 빠른 개발 |
| UI | React + Tailwind CSS | 빠른 UI 구축 |
| AI | OpenAI API (GPT-4o-mini) | 비용 효율적, HTML 생성 우수 |
| 배포 | Vercel | 무료, Next.js 최적화 |
| 상태 관리 | React useState/useRef | MVP에서 충분 (DB 불필요) |

> **AI 모델 선택 근거**: GPT-4o-mini는 단일 HTML 생성에 충분한 성능을 가지며 비용이 저렴함. 필요시 GPT-4o 또는 Claude로 교체 가능.

---

## 3. 화면 구성

### 3.1 시작 화면

```
┌─────────────────────────────────────────┐
│                                         │
│         🎨 바이브코딩 교실              │
│                                         │
│    ┌─────────────────────────────┐      │
│    │  주제를 입력하세요           │      │
│    │  예: 나만의 자기소개 페이지  │      │
│    └─────────────────────────────┘      │
│                                         │
│           [ 시작하기 ]                  │
│                                         │
└─────────────────────────────────────────┘
```

### 3.2 메인 작업 화면

```
┌──────────────────┬──────────────────────┐
│ 💬 AI 채팅       │ 👁 미리보기           │
│ (40%)            │ (60%)                │
│──────────────────│                      │
│ AI: 안녕! 오늘은 │                      │
│ "자기소개 페이지"│   (생성된 HTML을      │
│ 를 만들어볼거야! │    iframe으로 표시)   │
│                  │                      │
│ AI: 어떤 내용을  │                      │
│ 넣고 싶어?       │                      │
│                  │                      │
│ 나: 이름이랑     │                      │
│ 취미를 넣고 싶어 │                      │
│                  │                      │
│──────────────────│                      │
│ [메시지 입력...]  │                      │
│ [전송]           │                      │
└──────────────────┴──────────────────────┘
 상단 바: [주제: 자기소개 페이지]  [처음부터]
```

---

## 4. AI 워크플로우

### 4.1 단계별 흐름

```
[시작] → [안내] → [명세화] → [확인] → [생성] → [수정 루프] → [완성]
```

#### Phase 0: 안내 (학생 입력 전)
- AI가 주제를 소개하고 무엇을 만들지 설명
- 예시와 함께 학생의 아이디어를 끌어냄
- **AI 출력**: 인사 + 주제 안내 + 첫 질문

#### Phase 1: 명세화 (초안 전)
- 학생이 원하는 내용을 자유롭게 말함
- AI가 2~3번의 질문으로 요구사항 파악
- AI가 "페이지 명세"를 정리하여 보여줌
- **AI 출력**: 명세 요약 + "이대로 만들어볼까?"

#### Phase 2: 생성
- 학생이 확인하면 HTML 생성
- 생성된 HTML이 미리보기에 즉시 표시
- **AI 출력**: "만들었어! 오른쪽에서 확인해봐" + 주요 포인트 설명

#### Phase 3: 수정 루프 (반복)
- 학생이 수정 요청 → AI가 "변경 작업"으로 정리 → 확인 → 반영
- 반영 후 변경점 설명 + 다음 개선 힌트 제공
- **AI 출력**: 변경 요약 + 힌트 ("색상도 바꿔볼까?", "이미지를 추가해볼까?")

### 4.2 상태 관리

```
phase: "intro" | "spec" | "confirm_spec" | "generating" | "modify" | "confirm_modify"
```

- 상태에 따라 AI의 시스템 프롬프트가 달라짐
- 클라이언트에서 대화 히스토리 + 현재 HTML + phase를 관리

---

## 5. API 설계

### POST /api/chat

**Request:**
```json
{
  "topic": "자기소개 페이지",
  "messages": [
    { "role": "assistant", "content": "안녕! ..." },
    { "role": "user", "content": "이름이랑 취미를 넣고 싶어" }
  ],
  "currentHtml": "<html>...</html>",
  "phase": "spec"
}
```

**Response:**
```json
{
  "message": "좋아! 이렇게 정리해볼게...",
  "html": "<html>...</html>",
  "phase": "confirm_spec"
}
```

> `html` 필드는 Phase 2(생성) 이후부터 포함됨. Phase 0~1에서는 `null`.

---

## 6. 시스템 프롬프트 설계

### 6.1 기본 역할 프롬프트

```
너는 바이브코딩 교실의 AI 선생님이야.
학생이 코드를 몰라도 대화만으로 웹 페이지를 만들 수 있도록 도와줘.

규칙:
1. 반말로 친근하게 대화해 (초등~중학생 수준)
2. 한 번에 너무 많은 질문을 하지 마 (최대 2개)
3. 학생이 말한 것을 정리해서 확인받아
4. HTML을 생성할 때는 반드시 완전한 HTML 문서를 만들어
5. 수정할 때는 기존 HTML 전체를 새로 생성해 (diff가 아닌 전체 교체)
6. 주제에서 벗어나는 요청은 부드럽게 거절해
```

### 6.2 Phase별 추가 지시

| Phase | 추가 지시 |
|-------|-----------|
| intro | 주제를 소개하고 어떤 페이지를 만들 수 있는지 예시를 들어줘 |
| spec | 학생의 답변을 모아 "페이지 명세"로 정리해. 구성 요소를 목록으로 보여줘 |
| confirm_spec | 명세를 보여주고 "이대로 만들어볼까?"라고 물어봐 |
| generating | 명세에 맞는 HTML을 생성해. Tailwind CDN을 사용하고 보기 좋게 만들어 |
| modify | 변경 요청을 "변경 작업"으로 정리하고 확인받아 |
| confirm_modify | 변경 사항을 반영한 전체 HTML을 생성해 |

### 6.3 HTML 생성 규칙

```
HTML 생성 시 규칙:
1. 단일 HTML 파일로 완성 (외부 파일 참조 금지, CDN은 허용)
2. Tailwind CSS CDN 사용 (스타일링)
3. Google Fonts 사용 가능
4. 이미지는 placeholder 서비스 사용 (https://placehold.co/)
5. <script>는 최소한으로 (필요한 인터랙션만)
6. 모바일 반응형 기본 적용
7. 한글 지원
```

---

## 7. 가드레일

### 7.1 주제 고정
- 시스템 프롬프트에 주제를 명시하고 벗어나지 않도록 지시
- 주제와 무관한 요청 시: "우리 지금 {주제}를 만들고 있으니까, 그거에 집중해보자!"

### 7.2 콘텐츠 안전
- 폭력적/부적절한 내용 요청 거부
- 외부 스크립트 실행 제한 (iframe sandbox 속성 활용)

### 7.3 기술적 안전
```html
<iframe
  sandbox="allow-scripts allow-same-origin"
  srcdoc="..."
></iframe>
```
- iframe sandbox로 생성된 HTML의 권한 제한
- 외부 네비게이션 차단

---

## 8. 프로젝트 구조

```
vibecodingclass/
├── app/
│   ├── layout.tsx          # 루트 레이아웃
│   ├── page.tsx            # 시작 화면 (주제 입력)
│   ├── workspace/
│   │   └── page.tsx        # 메인 작업 화면
│   └── api/
│       └── chat/
│           └── route.ts    # AI 채팅 API
├── components/
│   ├── ChatPanel.tsx       # 채팅 패널
│   ├── ChatMessage.tsx     # 개별 메시지
│   ├── PreviewPanel.tsx    # HTML 미리보기 패널
│   ├── TopicInput.tsx      # 주제 입력 폼
│   └── TopBar.tsx          # 상단 바
├── lib/
│   ├── ai.ts               # AI API 호출 로직
│   ├── prompts.ts          # 시스템 프롬프트 관리
│   └── types.ts            # TypeScript 타입 정의
├── public/
├── package.json
├── tailwind.config.ts
├── tsconfig.json
└── .env.local              # OPENAI_API_KEY
```

---

## 9. 핵심 구현 사항

### 9.1 AI 응답 파싱

AI 응답에서 메시지와 HTML을 분리하는 전략:

```
방법: AI에게 JSON 형식으로 응답하도록 지시

응답 형식:
{
  "message": "학생에게 보여줄 메시지",
  "html": "생성된 HTML (없으면 null)",
  "phase": "다음 phase"
}
```

OpenAI의 `response_format: { type: "json_object" }` 옵션 활용.

### 9.2 스트리밍

- MVP에서는 스트리밍 미적용 (응답 완료 후 한번에 표시)
- 로딩 인디케이터로 대기 시간 커버
- 향후 개선시 스트리밍 추가 가능

### 9.3 대화 히스토리

- 클라이언트(React state)에서 메시지 배열 관리
- API 호출 시 전체 히스토리 전송
- 토큰 제한 초과 방지: 최근 20개 메시지 + 현재 HTML만 전송

---

## 10. MVP 범위

### 포함 (MVP)
- [x] 주제 입력 화면
- [x] 채팅 + 미리보기 분할 화면
- [x] AI 안내 → 명세화 → 생성 → 수정 루프
- [x] 가드레일 (주제 고정, 콘텐츠 안전)
- [x] 반응형 레이아웃
- [x] 처음부터 다시 시작 기능

### 제외 (향후)
- [ ] 사용자 인증/로그인
- [ ] 프로젝트 저장/불러오기
- [ ] 코드 보기/편집 모드
- [ ] 다중 페이지 프로젝트
- [ ] 협업 기능
- [ ] 스트리밍 응답
- [ ] 프로젝트 내보내기 (HTML 다운로드)
- [ ] 선생님 대시보드 (주제 관리)
- [ ] 학습 분석/리포트

---

## 11. 환경 변수

```env
OPENAI_API_KEY=sk-...        # OpenAI API 키 (필수)
NEXT_PUBLIC_APP_NAME=바이브코딩 교실  # 앱 이름
```

---

## 12. 예상 개발 일정 (MVP)

| 단계 | 내용 | 예상 |
|------|------|------|
| 1 | 프로젝트 셋업 + 기본 레이아웃 | - |
| 2 | 시작 화면 (주제 입력) | - |
| 3 | 채팅 UI + 미리보기 패널 | - |
| 4 | AI API 연동 + 프롬프트 설계 | - |
| 5 | 워크플로우 (Phase 관리) | - |
| 6 | 가드레일 + 테스트 | - |
| 7 | 스타일링 + 마무리 | - |
